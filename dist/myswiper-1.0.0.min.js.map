{"version":3,"file":"myswiper-1.0.0.min.js","sources":["../src/myswiper/myswiper.js"],"sourcesContent":["/*\r\n * Copyright (c) 2021.\r\n * leiming.\r\n * 自定义简单的Swiper组件\r\n */\r\nfunction Swiper(id,options = {\r\n        pageSize:3,\r\n        enablePlay:true,\r\n        pagePlayTime:5\r\n    }) {\r\n\r\n    //private filed\r\n    this.pageSize = 3;\r\n    if(options.pageSize){\r\n        this.pageSize = options.pageSize;\r\n    }\r\n    //当前播放第几页,默认第一页开始\r\n    this.page = 1;\r\n    //定时轮播\r\n    this.timer = 0;\r\n    //是否开启自动播放\r\n    this.enablePlay = true;\r\n    if(typeof options.enablePlay !== 'undefined' ){\r\n        this.enablePlay = options.enablePlay;\r\n    }\r\n    //多久自动轮播一次\r\n    this.pagePlayTime = 5*1000;\r\n    if(options.pagePlayTime){\r\n        this.pagePlayTime = options.pagePlayTime*1000;\r\n    }\r\n    this.sp = document.getElementById(id);\r\n    if(!this.sp){\r\n        throw new Error(\"swiper id is not exist\");\r\n    }\r\n    this.initDom();\r\n    //数据页元素\r\n    this.ul = this.sp.getElementsByClassName(\"ul\")[0];\r\n    //指标总元素\r\n    this.bp = this.sp.getElementsByClassName(\"b-p\")[0];\r\n    //初始化进入出去事件\r\n    this.moveIn = \"mouseover\";\r\n    this.moveOut = \"mouseout\";\r\n    if('ontouchstart' in window){\r\n        this.moveIn = \"touchstart\";\r\n        this.moveOut = \"touchend\";\r\n    }\r\n    this.initEvent();\r\n    if(this.enablePlay){\r\n        this.initTimer();\r\n    }\r\n};\r\n\r\n/**\r\n * 选择性初始化dom\r\n */\r\nSwiper.prototype.initDom = function(){\r\n    if(this.sp.getElementsByClassName(\"ul\").length == 0){\r\n        let ul =  document.createElement('ul');\r\n        ul.classList.add(\"ul\");\r\n        this.sp.appendChild(ul);\r\n    }\r\n    if(this.sp.getElementsByClassName(\"ol\").length == 0){\r\n        let ol = document.createElement('b-p');\r\n        ol.classList.add(\"b-p\");\r\n        this.sp.appendChild(ol);\r\n    }\r\n\r\n}\r\n/**\r\n * 初始化事件\r\n */\r\nSwiper.prototype.initEvent = function(){\r\n    /*视件代理类型写法\r\n    while(currentNode  !== event.currentTarget){\r\n        if(currentNode.matches(\".b-p .point\")){\r\n            //var index = currentNode.textContent;\r\n            [].slice.call(currentNode.parentNode.children).forEach(item=>{\r\n                item.classList.remove(\"at\");\r\n            });\r\n            var index = [].indexOf.call(currentNode.parentNode.children,currentNode);\r\n            var p = -100 * index;\r\n            ul.style.transform  = \"translateX(\"+p+\"%)\";\r\n            currentNode.classList.add(\"at\");\r\n            break;\r\n        }\r\n        currentNode = currentNode.parentNode;\r\n    }*/\r\n    this.initPointEvent();\r\n    //初始化进入及出去事件\r\n    this.initMoveEvent();\r\n\r\n};\r\n/**\r\n * 初始化园圈指标事件\r\n */\r\nSwiper.prototype.initPointEvent = function(){\r\n    this.sp.addEventListener('click',(event)=>{\r\n        var currentNode  = event.target;\r\n        var rc = event.currentTarget;\r\n        var ul = rc.getElementsByClassName(\"ul\")[0];\r\n        //事件代理写法\r\n        if(!currentNode.matches(\".b-p .point\")){\r\n            return ;\r\n        }\r\n        if(this.enablePlay){\r\n            this.clearTimer();\r\n        }\r\n        var index = [].indexOf.call(currentNode.parentNode.children,currentNode);\r\n        this.page = index+1;\r\n        this.goPage();\r\n        if(this.enablePlay){\r\n            this.initTimer();\r\n        }\r\n\r\n    },false);\r\n};\r\n/**\r\n * 当启用自动轮播时，元素进入及出去都暂停轮播\r\n */\r\nSwiper.prototype.initMoveEvent = function(){\r\n        if(!this.enablePlay){\r\n            return ;\r\n        }\r\n        this.ul.addEventListener(this.moveIn,this.onMoveIn.bind(this),false);\r\n        this.ul.addEventListener(this.moveOut,this.onMoveOut.bind(this),false);\r\n}\r\n\r\n/**\r\n * 进入事件\r\n * @param event\r\n */\r\nSwiper.prototype.onMoveIn = function(event){\r\n    this.clearTimer();\r\n}\r\n\r\n/**\r\n * 移出事件\r\n * @param event\r\n */\r\nSwiper.prototype.onMoveOut = function(event){\r\n    event.preventDefault();\r\n    this.initTimer();\r\n}\r\n\r\n/**\r\n * 启动自动轮播\r\n */\r\nSwiper.prototype.initTimer = function(){\r\n    this.timer = window.setInterval(()=>{\r\n        this.next();\r\n    },this.pagePlayTime)\r\n};\r\n/**\r\n * 清除自动跳转\r\n */\r\nSwiper.prototype.clearTimer = function(){\r\n    window.clearInterval(this.timer);\r\n};\r\n/**\r\n * 跳转到指定页\r\n * @param page\r\n */\r\nSwiper.prototype.goPage = function(page){\r\n    if(page){\r\n        this.page = page;\r\n    }\r\n    let currentNode = this.bp.children[this.page-1];\r\n    [].slice.call(this.bp.children).forEach(item=>{\r\n        item.classList.remove(\"at\");\r\n    });\r\n    var index = [].indexOf.call(currentNode.parentNode.children,currentNode);\r\n    var p = -100 * index;\r\n    this.ul.style.transform  = \"translateX(\"+p+\"%)\";\r\n    currentNode.classList.add(\"at\");\r\n};\r\n\r\n/**\r\n * 跳转到下一页\r\n */\r\nSwiper.prototype.next = function(){\r\n    var len = this.bp.children.length;\r\n    if(this.page >= len){\r\n        this.page = 1;\r\n    }else{\r\n        this.page++;\r\n    }\r\n    this.goPage();\r\n};\r\n\r\n/**\r\n * 动态添加一个元素\r\n * @param id\r\n * @param html  元素html内容\r\n * @param callback  添加后回调\r\n */\r\nSwiper.prototype.add = function(id,html,callback){\r\n    //判断是否要添加指示\r\n    let len = this.ul.children.length;\r\n    let addPoint = false;\r\n    //判断是否要添加指示园圈，如果现在刚好不用添加，那添加一个元素之后肯定是要添加的\r\n    if(len % this.pageSize === 0){\r\n        addPoint = true;\r\n    }\r\n    //内容\r\n    let li = document.createElement('li');\r\n    let box = document.createElement('div');\r\n    box.classList.add(\"c-box\");\r\n    if(id){\r\n        box.setAttribute(\"id\",id);\r\n    }\r\n    if(html){\r\n        box.innerHTML = html;\r\n    }\r\n    li.appendChild(box);\r\n\r\n    this.ul.appendChild(li);\r\n    //需要添加指标园圈\r\n    if(addPoint){\r\n        //内容\r\n        let pointLi =document.createElement('li');\r\n        pointLi.textContent = this.bp.children.length + 1;\r\n        pointLi.classList.add(\"point\")\r\n        //如果是第一个添加\r\n        if(this.bp.children.length == 0){\r\n            pointLi.classList.add(\"at\")\r\n        }\r\n        this.bp.appendChild(pointLi);\r\n\r\n    }\r\n    if(typeof callback === 'function'){\r\n        callback.call(this);\r\n    }\r\n};\r\n\r\nSwiper.prototype.destroy = function(){\r\n    this.sp = null;\r\n    this.ul = null;\r\n    this.bp = null;\r\n    this.clearTimer();\r\n    if(this.enablePlay){\r\n        this.ul.removeEventListener(this.moveIn,this.onMoveIn);\r\n        this.ul.addEventListener(this.moveOut,this.onMoveOut);\r\n    }\r\n};\r\n\r\nexport default  Swiper;"],"names":["Swiper","id","options","pageSize","enablePlay","pagePlayTime","page","timer","sp","document","getElementById","this","Error","initDom","ul","getElementsByClassName","bp","moveIn","moveOut","window","initEvent","initTimer","prototype","ol","length","createElement","classList","add","appendChild","initPointEvent","initMoveEvent","addEventListener","event","currentNode","target","currentTarget","matches","_this","clearTimer","index","indexOf","call","parentNode","children","goPage","onMoveIn","bind","onMoveOut","preventDefault","setInterval","_this2","next","clearInterval","slice","forEach","item","remove","style","transform","html","callback","addPoint","li","box","setAttribute","innerHTML","pointLi","textContent","destroy","removeEventListener"],"mappings":"wOAKA,SAASA,EAAOC,OAAGC,yDAAU,CACrBC,SAAS,EACTC,YAAW,EACXC,aAAa,WAIZF,SAAW,EACbD,EAAQC,gBACFA,SAAWD,EAAQC,eAGvBG,KAAO,OAEPC,MAAQ,OAERH,YAAa,OACe,IAAvBF,EAAQE,kBACTA,WAAaF,EAAQE,iBAGzBC,aAAe,IACjBH,EAAQG,oBACFA,aAAoC,IAArBH,EAAQG,mBAE3BG,GAAKC,SAASC,eAAeT,IAC9BU,KAAKH,SACKI,MAAM,+BAEfC,eAEAC,GAAKH,KAAKH,GAAGO,uBAAuB,MAAM,QAE1CC,GAAKL,KAAKH,GAAGO,uBAAuB,OAAO,QAE3CE,OAAS,iBACTC,QAAU,WACZ,iBAAkBC,cACZF,OAAS,kBACTC,QAAU,iBAEdE,YACFT,KAAKP,iBACCiB,mBAObrB,EAAOsB,UAAUT,QAAU,eAOfU,EAN0C,GAA/CZ,KAAKH,GAAGO,uBAAuB,MAAMS,UAChCV,EAAML,SAASgB,cAAc,OAC9BC,UAAUC,IAAI,WACZnB,GAAGoB,YAAYd,IAE0B,GAA/CH,KAAKH,GAAGO,uBAAuB,MAAMS,UAChCD,EAAKd,SAASgB,cAAc,QAC7BC,UAAUC,IAAI,YACZnB,GAAGoB,YAAYL,KAO5BvB,EAAOsB,UAAUF,UAAY,gBAgBpBS,sBAEAC,iBAMT9B,EAAOsB,UAAUO,eAAiB,2BACzBrB,GAAGuB,iBAAiB,QAAQ,SAACC,OAC1BC,EAAeD,EAAME,OAChBF,EAAMG,cACHpB,uBAAuB,MAE/BkB,EAAYG,QAAQ,iBAGrBC,EAAKjC,YACJiC,EAAKC,aAELC,EAAQ,GAAGC,QAAQC,KAAKR,EAAYS,WAAWC,SAASV,GAC5DI,EAAK/B,KAAOiC,EAAM,EAClBF,EAAKO,SACFP,EAAKjC,YACJiC,EAAKhB,eAGX,IAKNrB,EAAOsB,UAAUQ,cAAgB,WACrBnB,KAAKP,kBAGJU,GAAGiB,iBAAiBpB,KAAKM,OAAON,KAAKkC,SAASC,KAAKnC,OAAM,QACzDG,GAAGiB,iBAAiBpB,KAAKO,QAAQP,KAAKoC,UAAUD,KAAKnC,OAAM,KAOxEX,EAAOsB,UAAUuB,SAAW,SAASb,QAC5BM,cAOTtC,EAAOsB,UAAUyB,UAAY,SAASf,GAClCA,EAAMgB,sBACD3B,aAMTrB,EAAOsB,UAAUD,UAAY,2BACpBd,MAAQY,OAAO8B,YAAY,WAC5BC,EAAKC,QACPxC,KAAKN,eAKXL,EAAOsB,UAAUgB,WAAa,WAC1BnB,OAAOiC,cAAczC,KAAKJ,QAM9BP,EAAOsB,UAAUsB,OAAS,SAAStC,GAC5BA,SACMA,KAAOA,OAEZ2B,EAActB,KAAKK,GAAG2B,SAAShC,KAAKL,KAAK,MAC1C+C,MAAMZ,KAAK9B,KAAKK,GAAG2B,UAAUW,QAAQ,SAAAC,GACpCA,EAAK7B,UAAU8B,OAAO,QAEtBjB,EAAQ,GAAGC,QAAQC,KAAKR,EAAYS,WAAWC,SAASV,QAEvDnB,GAAG2C,MAAMC,UAAa,eADlB,IAAMnB,EAC4B,KAC3CN,EAAYP,UAAUC,IAAI,OAM9B3B,EAAOsB,UAAU6B,KAAO,WAEjBxC,KAAKL,KADEK,KAAKK,GAAG2B,SAASnB,YAIlBlB,YAFAA,KAAO,OAIXsC,UAST5C,EAAOsB,UAAUK,IAAM,SAAS1B,EAAG0D,EAAKC,OAGhCC,GAAW,EADLlD,KAAKG,GAAG6B,SAASnB,OAGlBb,KAAKR,UAAa,IACvB0D,GAAW,OAGXC,EAAKrD,SAASgB,cAAc,MAC5BsC,EAAMtD,SAASgB,cAAc,OACjCsC,EAAIrC,UAAUC,IAAI,SACf1B,GACC8D,EAAIC,aAAa,KAAK/D,GAEvB0D,IACCI,EAAIE,UAAYN,GAEpBG,EAAGlC,YAAYmC,QAEVjD,GAAGc,YAAYkC,GAEjBD,KAEKK,EAASzD,SAASgB,cAAc,OAC5B0C,YAAcxD,KAAKK,GAAG2B,SAASnB,OAAS,EAChD0C,EAAQxC,UAAUC,IAAI,SAEQ,GAA3BhB,KAAKK,GAAG2B,SAASnB,QAChB0C,EAAQxC,UAAUC,IAAI,WAErBX,GAAGY,YAAYsC,IAGD,mBAAbN,GACNA,EAASnB,KAAK9B,OAItBX,EAAOsB,UAAU8C,QAAU,gBAClB5D,GAAK,UACLM,GAAK,UACLE,GAAK,UACLsB,aACF3B,KAAKP,kBACCU,GAAGuD,oBAAoB1D,KAAKM,OAAON,KAAKkC,eACxC/B,GAAGiB,iBAAiBpB,KAAKO,QAAQP,KAAKoC"}